<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="莫听穿林打叶声，何妨吟啸且徐行。竹杖芒鞋轻胜马，谁怕？ 一蓑烟雨任平生。料峭春风吹酒醒，微冷，山头斜照却相迎。回首向来萧瑟处，归去，也无风雨也无晴。"><title>spring 集中式处理异常 | 一蓑烟雨任平生</title><link rel="stylesheet" type="text/css" href="//fonts.css.network/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1.5"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=1.1.5"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">spring 集中式处理异常</h1><a id="logo" href="/.">一蓑烟雨任平生</a><p class="description">十年前你是谁，一年前你是谁，甚至昨天你是谁，都不重要。重要的是，今天你是谁，以及明天你将成为谁</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/guestbook/"><i class="fa fa-archive"> 留言</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="layout-g"><div class="layout-r"><div id="sidebar"><div class="widget"><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="请输入关键字..."/></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/apache-shiro/">apache-shiro</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/csrf攻击/">csrf攻击</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/dubbo/">dubbo</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/elasticSearch/">elasticSearch</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/gerrit/">gerrit</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/markdown/">markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/maven/">maven</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/memcached/">memcached</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongo/">mongo</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/nexus/">nexus</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/nginx/">nginx</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/nodejs/">nodejs</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/poi/">poi</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reactjs/">reactjs</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/redis/">redis</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/spring/">spring</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ssh/">ssh</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/zsh/">zsh</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/分布式/">分布式</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/多线程/">多线程</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/微信/">微信</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/想法/">想法</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/搬瓦工ss/">搬瓦工ss</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/支付接口/">支付接口</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/腾讯云/">腾讯云</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/设计模式/">设计模式</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/重构代码/">重构代码</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/阿里云/">阿里云</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/nodejs/" style="font-size: 15px;">nodejs</a> <a href="/tags/dubbo-admin/" style="font-size: 15px;">dubbo-admin</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/生活/" style="font-size: 15px;">生活</a> <a href="/tags/多线程/" style="font-size: 15px;">多线程</a> <a href="/tags/shell/" style="font-size: 15px;">shell</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/权限框架/" style="font-size: 15px;">权限框架</a> <a href="/tags/csrf攻击/" style="font-size: 15px;">csrf攻击</a> <a href="/tags/elasticSearch/" style="font-size: 15px;">elasticSearch</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/gerrit/" style="font-size: 15px;">gerrit</a> <a href="/tags/日志框架/" style="font-size: 15px;">日志框架</a> <a href="/tags/memcached/" style="font-size: 15px;">memcached</a> <a href="/tags/mongo/" style="font-size: 15px;">mongo</a> <a href="/tags/mongo/" style="font-size: 15px;">-mongo</a> <a href="/tags/mysql/" style="font-size: 15px;">-mysql</a> <a href="/tags/nexus/" style="font-size: 15px;">nexus</a> <a href="/tags/maven/" style="font-size: 15px;">maven</a> <a href="/tags/poi/" style="font-size: 15px;">poi</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/reactjs/" style="font-size: 15px;">reactjs</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/spring/" style="font-size: 15px;">spring</a> <a href="/tags/分布式/" style="font-size: 15px;">分布式</a> <a href="/tags/微信/" style="font-size: 15px;">微信</a> <a href="/tags/搬瓦工ss/" style="font-size: 15px;">搬瓦工ss</a> <a href="/tags/支付接口/" style="font-size: 15px;">支付接口</a> <a href="/tags/数据库/" style="font-size: 15px;">数据库</a> <a href="/tags/腾讯云/" style="font-size: 15px;">腾讯云</a> <a href="/tags/设计模式/" style="font-size: 15px;">设计模式</a> <a href="/tags/重构代码/" style="font-size: 15px;">重构代码</a> <a href="/tags/阿里云/" style="font-size: 15px;">阿里云</a> <a href="/tags/markdown/" style="font-size: 15px;">markdown</a> <a href="/tags/ssh/" style="font-size: 15px;">ssh</a> <a href="/tags/想法/" style="font-size: 15px;">想法</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-fei"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/03/28/webStorm-ide处理markdown代码空格问题/">webStorm ide处理markdown代码空格问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/28/auth-token问题/">auth token问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/27/ssh服务器免密登陆/">ssh服务器免密登陆</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/27/spring-集中式处理异常/">spring 集中式处理异常</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/27/每天想对自己说的话/">每天想对自己说的话</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/26/elasticsearch-启动报错-aliyun/">elasticsearch 启动报错-aliyun</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/24/设计模式-桥接模式/">设计模式-桥接模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/23/设计模式-责任链模式/">设计模式-责任链模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/23/设计模式-策略模式/">设计模式-策略模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/23/设计模式-工厂模式/">设计模式-工厂模式</a></li></ul></div></div></div><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">spring 集中式处理异常</h1><div class="post-meta">Mar 27, 2017<span> | </span><span class="category"><a href="/categories/spring/">spring</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><h1 id="spring-集中处理异常"><a href="#spring-集中处理异常" class="headerlink" title="spring 集中处理异常"></a>spring 集中处理异常</h1><h2 id="传统处理"><a href="#传统处理" class="headerlink" title="传统处理"></a>传统处理</h2><p>传统处理异常多通过try-catch进行捕捉，如此的话会出现code不清晰、异常处理很乱的情况，返回给 移动端、web端接口异常不清晰、不友好等问题</p>
<h2 id="spring集中式"><a href="#spring集中式" class="headerlink" title="spring集中式"></a>spring集中式</h2><h3 id="aop"><a href="#aop" class="headerlink" title="aop"></a>aop</h3><p>利用aop对所有控制层即controller层 进行代理，形成类似try-catch式异常捕捉处理</p>
<h3 id="spring提供的异常处理机制"><a href="#spring提供的异常处理机制" class="headerlink" title="spring提供的异常处理机制"></a>spring提供的异常处理机制</h3><p>spring3.2后提供的注解 @ControllerAdvice  @ExceptionHandler注解，实现全局处理异常<br>代码：</p>
<h4 id="自定义异常类DiyException"><a href="#自定义异常类DiyException" class="headerlink" title="自定义异常类DiyException"></a>自定义异常类DiyException</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created with IntelliJ IDEA.</div><div class="line"> * ClassName: com.edianzu.cloud.assets.web.exceptionHandler.DiyException</div><div class="line"> * User: bifenghui</div><div class="line"> * Date: 2017/3/27</div><div class="line"> * Time: 下午10:22</div><div class="line"> * To change this template use File | Settings | File Templates.</div><div class="line"> * Description:</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DiyException</span> <span class="keyword">extends</span> <span class="title">Exception</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> Integer exceptionCode ;</div><div class="line">    <span class="keyword">private</span> String exceptionMsg;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DiyException</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DiyException</span><span class="params">(Integer exceptionCode, String exceptionMsg)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.exceptionCode = exceptionCode;</div><div class="line">        <span class="keyword">this</span>.exceptionMsg = exceptionMsg;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DiyException</span><span class="params">(DiyExceptionCode diyExceptionCode)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.exceptionCode = diyExceptionCode.getCode();</div><div class="line">        <span class="keyword">this</span>.exceptionMsg = diyExceptionCode.getMsg();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getExceptionCode</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> exceptionCode;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setExceptionCode</span><span class="params">(Integer exceptionCode)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.exceptionCode = exceptionCode;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getExceptionMsg</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> exceptionMsg;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setExceptionMsg</span><span class="params">(String exceptionMsg)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.exceptionMsg = exceptionMsg;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="自定义异常枚举返回码"><a href="#自定义异常枚举返回码" class="headerlink" title="自定义异常枚举返回码"></a>自定义异常枚举返回码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created with IntelliJ IDEA.</div><div class="line"> * EnumName: com.edianzu.cloud.assets.web.exceptionHandler.DiyExceptionCode</div><div class="line"> * User: bifenghui@edianzu.cn</div><div class="line"> * Date: 2017/3/27</div><div class="line"> * Time: 下午10:32</div><div class="line"> * To change this template use File | Settings | File Templates.</div><div class="line"> * Description:</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="keyword">enum</span> DiyExceptionCode &#123;</div><div class="line">    NOT_KONW_ERROR(<span class="number">9999</span>,<span class="string">"未知错误"</span>);</div><div class="line">    <span class="comment">// <span class="doctag">TODO:</span> 2017/3/27  继续定义多种异常枚举code</span></div><div class="line">    <span class="keyword">private</span> Integer code;</div><div class="line">    <span class="keyword">private</span> String msg;</div><div class="line">    DiyExceptionCode(Integer i, String msg) &#123;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getCode</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> code;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode</span><span class="params">(Integer code)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.code = code;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMsg</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> msg;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMsg</span><span class="params">(String msg)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.msg = msg;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="自定义返回简单格式的返回体"><a href="#自定义返回简单格式的返回体" class="headerlink" title="自定义返回简单格式的返回体"></a>自定义返回简单格式的返回体</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created with IntelliJ IDEA.</div><div class="line"> * ClassName: com.edianzu.cloud.assets.web.exceptionHandler.DiyResponse</div><div class="line"> * User: bifenghui</div><div class="line"> * Date: 2017/3/27</div><div class="line"> * Time: 下午10:23</div><div class="line"> * To change this template use File | Settings | File Templates.</div><div class="line"> * Description:</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DiyResponse</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Integer code;</div><div class="line">    <span class="keyword">private</span> T data;</div><div class="line">    <span class="keyword">private</span> String errorMsg;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DiyResponse</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DiyResponse</span><span class="params">(Integer code, T data, String errorMsg)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.code = code;</div><div class="line">        <span class="keyword">this</span>.data = data;</div><div class="line">        <span class="keyword">this</span>.errorMsg = errorMsg;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DiyResponse</span><span class="params">(DiyExceptionCode diyExceptionCode)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.code = diyExceptionCode.getCode();</div><div class="line">        <span class="keyword">this</span>.errorMsg = diyExceptionCode.getMsg();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getCode</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> code;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode</span><span class="params">(Integer code)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.code = code;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getData</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> data;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(T data)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.data = data;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getErrorMsg</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> errorMsg;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setErrorMsg</span><span class="params">(String errorMsg)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.errorMsg = errorMsg;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="处理全局异常的类"><a href="#处理全局异常的类" class="headerlink" title="处理全局异常的类"></a>处理全局异常的类</h4><p>ControllerAdvice 注解类，ExceptionHandler注解异常方法。<br><strong>想法：原理也基于aop代理，后置通知实现，此处需要查看源码或spring工具书进行求证</strong><br><strong>注：此处可以让全局异常类继承 ResponseEntityExceptionHandler 类，查看<br>ResponseEntityExceptionHandler源码可以看到此类中也使@ExceptionHandler注解，且处理了多种异常，最终封装异常信息到ResponseEntity（可以查看ResponseEntity源码追朔到HttpEntity到HttpHeaders）,得到发现返回一个封装的非常的明确的遵循restful接口规范的返回（笔记末尾添上HttpHeaders源码）</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created with IntelliJ IDEA.</div><div class="line"> * ClassName: com.edianzu.cloud.assets.web.exceptionHandler.ExceptionTest</div><div class="line"> * User: bifenghui</div><div class="line"> * Date: 2017/3/27</div><div class="line"> * Time: 下午10:14</div><div class="line"> * To change this template use File | Settings | File Templates.</div><div class="line"> * Description:</div><div class="line"> */</div><div class="line"><span class="meta">@ControllerAdvice</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExceptionTest</span> <span class="keyword">extends</span> <span class="title">ResponseEntityExceptionHandler</span> </span>&#123;</div><div class="line">    <span class="comment">// <span class="doctag">TODO:</span> 2017/3/27 定义全局的异常捕获</span></div><div class="line">    <span class="meta">@ResponseBody</span></div><div class="line">    <span class="meta">@ExceptionHandler</span>(Throwable.class)</div><div class="line">    <span class="function"><span class="keyword">public</span> DiyResponse&lt;String&gt; <span class="title">excuteException</span><span class="params">(Throwable throwable)</span></span>&#123;</div><div class="line">        DiyResponse&lt;String&gt; diyResponse = <span class="keyword">new</span> DiyResponse&lt;&gt;();</div><div class="line">        <span class="comment">// <span class="doctag">TODO:</span> 2017/3/27 假如异常是以及被捕获需要抛出异常</span></div><div class="line">        <span class="keyword">if</span> (throwable <span class="keyword">instanceof</span> DiyException) &#123;</div><div class="line">            DiyException diyException = (DiyException) throwable;</div><div class="line">            diyResponse.setCode(diyException.getExceptionCode());</div><div class="line">            diyResponse.setErrorMsg(diyException.getExceptionMsg());</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// <span class="doctag">TODO:</span> 2017/3/27 此处定义出现未明确标记的异常时需要返回的信息</span></div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            diyResponse = <span class="keyword">new</span> DiyResponse&lt;&gt;(DiyExceptionCode.NOT_KONW_ERROR);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> diyResponse;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="实现实现-HandlerExceptionResolver-接口"><a href="#实现实现-HandlerExceptionResolver-接口" class="headerlink" title="实现实现 HandlerExceptionResolver 接口"></a>实现实现 HandlerExceptionResolver 接口</h3><p>可以定义spring bean 实现HandlerExceptionResolver 来处理全局异常</p>
<p>##HttpHeaders<br><a href="https://github.com/bifenghui/temp-code/blob/master/HttpHeaders.java" title="HttpHeaders.java" target="_blank" rel="external">HttpHeaders.java</a></p>
</div><div class="tags"><a href="/tags/spring/">spring</a></div><div class="post-nav"><a href="/2017/03/27/ssh服务器免密登陆/" class="pre">ssh服务器免密登陆</a><a href="/2017/03/27/每天想对自己说的话/" class="next">每天想对自己说的话</a></div><div id="comments"></div></div></div></div></div><a id="totop" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.1.5" async></script><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |<a href="/atom.xml">订阅本站</a> |<span>联系博主：<a href="mailto:fengdoubfh123@163.com" target="_blank" class="fa fa-email"> </a><a href="http://weibo.com/u/6187488535/home" target="_blank" class="fa fa-weibo"></a><a href="https://github.com/bifenghui" target="_blank" class="fa fa-github"> </a></span></p><!--p--><!--  span  Copyright &copy;--><!--    a(href=url_for('.'), rel='nofollow')= config.author || config.title + '.'--><!--  span  Powered by--><!--    a(rel='nofollow', target='_blank', href='https://hexo.io')  Hexo.--><!--  span--><!--    a(rel='nofollow', target='_blank', href='https://github.com/chaooo/hexo-theme-BlueLake')  Theme--><!--    | by--><!--    a(rel='nofollow', target='_blank', href='https://github.com/chaooo')  Charles.--></div></div></div><script type="text/javascript" src="/js/search.json.js?v=1.1.5"></script></body></html>